use crate::sbom_generation::domain::services::ThresholdConfig;
use crate::sbom_generation::domain::Package;

/// VulnerabilityCheckRequest - Request DTO for vulnerability checking use case
///
/// This DTO encapsulates all parameters needed to perform a vulnerability
/// check with threshold evaluation on a set of packages.
#[allow(dead_code)]
#[derive(Debug, Clone)]
pub struct VulnerabilityCheckRequest {
    /// Packages to check for vulnerabilities
    pub packages: Vec<Package>,
    /// Threshold configuration for filtering vulnerabilities
    pub threshold: ThresholdConfig,
    /// Package names to exclude from vulnerability checking
    pub excluded_packages: Vec<String>,
}

#[allow(dead_code)]
impl VulnerabilityCheckRequest {
    /// Creates a new VulnerabilityCheckRequest
    ///
    /// # Arguments
    /// * `packages` - List of packages to check for vulnerabilities
    /// * `threshold` - Threshold configuration (severity or CVSS based)
    /// * `excluded_packages` - List of package names to exclude from checking
    pub fn new(
        packages: Vec<Package>,
        threshold: ThresholdConfig,
        excluded_packages: Vec<String>,
    ) -> Self {
        Self {
            packages,
            threshold,
            excluded_packages,
        }
    }
}
