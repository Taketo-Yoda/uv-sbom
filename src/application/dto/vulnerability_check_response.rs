use crate::sbom_generation::domain::services::VulnerabilityCheckResult;

/// VulnerabilityCheckResponse - Response DTO for vulnerability checking use case
///
/// This DTO wraps the domain result and provides application-level
/// information about the vulnerability check outcome.
///
/// Note: Will be used by issue #94 (threshold-based exit code feature)
#[allow(dead_code)]
#[derive(Debug, Clone)]
pub struct VulnerabilityCheckResponse {
    /// The detailed result from the vulnerability checker
    pub result: VulnerabilityCheckResult,
    /// Whether any vulnerability exceeded the configured threshold
    pub has_threshold_exceeded: bool,
}

#[allow(dead_code)]
impl VulnerabilityCheckResponse {
    /// Creates a new VulnerabilityCheckResponse
    ///
    /// # Arguments
    /// * `result` - The vulnerability check result from the domain service
    /// * `has_threshold_exceeded` - Flag indicating if threshold was exceeded
    pub fn new(result: VulnerabilityCheckResult, has_threshold_exceeded: bool) -> Self {
        Self {
            result,
            has_threshold_exceeded,
        }
    }

    /// Creates a response from a VulnerabilityCheckResult
    ///
    /// The `has_threshold_exceeded` flag is derived from the result.
    pub fn from_result(result: VulnerabilityCheckResult) -> Self {
        let has_threshold_exceeded = result.threshold_exceeded;
        Self {
            result,
            has_threshold_exceeded,
        }
    }
}
